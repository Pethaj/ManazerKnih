<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test User Data Integration - Wany Chat</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    h1 {
      color: #2563eb;
      margin-bottom: 10px;
    }
    
    .info {
      background: #eff6ff;
      border-left: 4px solid #2563eb;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 4px;
    }
    
    .info h3 {
      margin-top: 0;
      color: #1e40af;
    }
    
    .warning {
      background: #fef3c7;
      border-left: 4px solid #f59e0b;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 4px;
    }
    
    .success {
      background: #d1fae5;
      border-left: 4px solid #10b981;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 4px;
    }
    
    .error {
      background: #fee2e2;
      border-left: 4px solid #ef4444;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 4px;
    }
    
    #status {
      margin-bottom: 20px;
      min-height: 100px;
    }
    
    .status-item {
      padding: 8px;
      margin: 5px 0;
      border-radius: 4px;
      font-family: monospace;
      font-size: 14px;
    }
    
    .status-success {
      background: #d1fae5;
      color: #065f46;
    }
    
    .status-error {
      background: #fee2e2;
      color: #991b1b;
    }
    
    .status-info {
      background: #eff6ff;
      color: #1e40af;
    }
    
    iframe {
      width: 100%;
      height: 700px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      margin-top: 20px;
    }
    
    code {
      background: #f3f4f6;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: monospace;
    }
  </style>
</head>
<body>
  
  <div class="container">
    <h1>ğŸ§ª Test User Data Integration - Wany Chat</h1>
    
    <div class="info">
      <h3>ğŸ“‹ Co tento test dÄ›lÃ¡:</h3>
      <p>1. NaÄte Wany Chat iframe z <code>http://localhost:5173/embed.html</code></p>
      <p>2. Po naÄtenÃ­ poÅ¡le testovacÃ­ user data pÅ™es <code>postMessage</code></p>
      <p>3. Zkontroluje, jestli data dorazila do iframe</p>
      <p>4. ZobrazÃ­ detailnÃ­ logy v sekci nÃ­Å¾e</p>
    </div>
    
    <div class="warning">
      <h3>âš ï¸ DÅ¯leÅ¾itÃ©:</h3>
      <p><strong>OtevÅ™i konzoli (F12)</strong> a sleduj logy!</p>
      <p>V konzoli by mÄ›ly bÃ½t vidÄ›t:</p>
      <ul>
        <li>âœ… <code>Iframe nalezen</code></li>
        <li>âœ… <code>Iframe naÄtenÃ½ (load event)</code></li>
        <li>âœ… <code>postMessage odeslÃ¡n!</code></li>
        <li>âœ… <code>ğŸ‘¤ User data pÅ™ijata z rodiÄe pÅ™es postMessage</code> (z tvÃ© aplikace)</li>
      </ul>
    </div>
    
    <div id="status">
      <h3>ğŸ“Š Status integrace:</h3>
      <div id="status-logs"></div>
    </div>
    
    <!-- IFRAME -->
    <div style="border: 2px dashed #2563eb; padding: 10px; border-radius: 8px; margin-bottom: 20px;">
      <p style="margin: 0 0 10px 0;"><strong>Wany Chat Iframe:</strong></p>
      <iframe 
        id="wany-chat-iframe" 
        src="http://localhost:5173/embed.html"
        allow="clipboard-write" 
        title="Wany Chat Test"
      ></iframe>
    </div>
  </div>

  <!-- JAVASCRIPT - TESTOVACÃ KÃ“D -->
  <script>
  // Helper funkce pro logovÃ¡nÃ­
  const statusLogs = document.getElementById('status-logs');
  
  function addLog(message, type = 'info') {
    const div = document.createElement('div');
    div.className = `status-item status-${type}`;
    div.textContent = message;
    statusLogs.appendChild(div);
    
    // Scroll dolÅ¯
    statusLogs.scrollTop = statusLogs.scrollHeight;
  }
  
  console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
  console.log('ğŸ§ª TEST USER DATA INTEGRATION - START');
  console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
  
  addLog('ğŸ”§ JavaScript inicializovÃ¡n', 'info');
  console.log('ğŸ”§ JavaScript zaÄÃ­nÃ¡...');
  
  (function() {
    const iframe = document.getElementById('wany-chat-iframe');
    
    if (!iframe) {
      const errorMsg = 'âŒ CHYBA: Iframe nenalezen! ID: wany-chat-iframe';
      console.error(errorMsg);
      addLog(errorMsg, 'error');
      return;
    }
    
    const successMsg = 'âœ… Iframe nalezen: ' + iframe.id;
    console.log(successMsg, iframe);
    addLog(successMsg, 'success');
    
    function sendUserData() {
      console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
      console.log('ğŸ“¤ ODESÃLÃM USER DATA DO IFRAME');
      console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
      
      addLog('ğŸ“¤ PÅ™ipravuji user data...', 'info');
      
      const userData = {
        id: '12345',
        firstName: 'Marcel',
        lastName: 'Haim',
        email: 'marcel.haim@bewit.cz',
        position: 'Supervisor'
      };
      
      console.log('ğŸ“¦ User data:', userData);
      addLog('ğŸ“¦ User data: ' + JSON.stringify(userData, null, 2), 'info');
      
      try {
        iframe.contentWindow.postMessage({
          type: 'USER_DATA',
          user: userData
        }, 'http://localhost:5173');
        
        const successMsg = 'âœ… postMessage ÃšSPÄšÅ NÄš ODESLÃN do iframe!';
        console.log(successMsg);
        addLog(successMsg, 'success');
        
        console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
        console.log('â³ TEÄ ÄŒEKÃM NA ODPOVÄšÄ Z IFRAME...');
        console.log('   (v konzoli by mÄ›l bÃ½t log z EmbedVanyChat.tsx)');
        console.log('   OÄekÃ¡vÃ¡m: "ğŸ‘¤ User data pÅ™ijata z rodiÄe pÅ™es postMessage"');
        console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
        
        addLog('â³ ÄŒekÃ¡m na potvrzenÃ­ z iframe...', 'info');
        addLog('ğŸ’¡ Sleduj konzoli - mÄ›l by se objevit log z aplikace', 'info');
        
        // Po 3 sekundÃ¡ch zkontrolujeme, jestli data dorazila
        setTimeout(() => {
          addLog('â° Timeout: Zkontroluj konzoli - objevil se tam log z aplikace?', 'info');
          addLog('ğŸ“‹ Hledej: "ğŸ‘¤ User data pÅ™ijata z rodiÄe pÅ™es postMessage"', 'info');
        }, 3000);
        
      } catch (error) {
        const errorMsg = 'âŒ CHYBA pÅ™i odesÃ­lÃ¡nÃ­ postMessage: ' + error.message;
        console.error(errorMsg, error);
        addLog(errorMsg, 'error');
      }
    }
    
    // Event listener pro naÄtenÃ­ iframe
    iframe.addEventListener('load', function() {
      const successMsg = 'âœ… Iframe naÄtenÃ½ (load event)';
      console.log(successMsg);
      addLog(successMsg, 'success');
      
      console.log('â³ ÄŒekÃ¡m 1 sekundu pÅ™ed odeslÃ¡nÃ­m dat (pro jistotu)...');
      addLog('â³ ÄŒekÃ¡m 1 sekundu...', 'info');
      
      // PoÄkÃ¡me 1 sekundu pro jistotu, Å¾e se aplikace v iframe inicializovala
      setTimeout(sendUserData, 1000);
    });
    
    console.log('â³ ÄŒekÃ¡m na naÄtenÃ­ iframe...');
    addLog('â³ ÄŒekÃ¡m na naÄtenÃ­ iframe...', 'info');
    
  })();
  
  // Naslouchej takÃ© zprÃ¡vÃ¡m zpÄ›t z iframe (volitelnÃ©)
  window.addEventListener('message', function(event) {
    console.log('ğŸ“¨ PÅ™ijata zprÃ¡va z iframe:', event);
    if (event.origin === 'http://localhost:5173') {
      console.log('ğŸ“¦ Data z iframe:', event.data);
      addLog('ğŸ“¨ ZprÃ¡va z iframe: ' + JSON.stringify(event.data), 'success');
    }
  });
  
  </script>
  
</body>
</html>
