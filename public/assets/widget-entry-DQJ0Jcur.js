const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SanaChat-Bj63mdfm.js","assets/SanaChat-MPqx-1mk.css"])))=>i.map(i=>d[i]);
import{r,j as t,F as p,h as x,R as w}from"./SanaChat-Bj63mdfm.js";import{_ as y}from"./preload-helper-ckwbz45p.js";import{g as _}from"./customAuthService-2eqph3FC.js";function v(){const e=new URLSearchParams(window.location.search);return{chatbotId:e.get("chatbot")||"vany_chat",theme:e.get("theme")||"light",greeting:e.get("greeting")||void 0,position:e.get("position")||"bottom-right",width:e.get("width")?parseInt(e.get("width")):400,height:e.get("height")?parseInt(e.get("height")):600}}async function C(e){try{const{supabase:n}=await y(async()=>{const{supabase:c}=await import("./SanaChat-Bj63mdfm.js").then(l=>l.i);return{supabase:c}},__vite__mapDeps([0,1])),{data:o,error:i}=await n.from("chatbot_settings").select("*").eq("chatbot_id",e).single();return i?(console.error("Error loading chatbot settings:",i),{chatbot_id:e,chatbot_name:"Vany Chat",product_recommendations:!0,product_button_recommendations:!0,book_database:!1,use_feed_1:!0,use_feed_2:!0,inline_product_links:!1,enable_product_router:!0,enable_manual_funnel:!1,webhook_url:"https://n8n.srv980546.hstgr.cloud/webhook/97dc857e-352b-47b4-91cb-bc134afc764c/chat"}):o}catch(n){return console.error("Failed to load chatbot settings:",n),null}}function j(e){const n=document.documentElement;e==="dark"?n.classList.add("dark"):n.classList.remove("dark"),console.log(`ðŸŽ¨ TÃ©ma nastaveno na: ${e}`)}function E(){try{return window.self!==window.top}catch{return!0}}function s(e,...n){console.log(`[Vany Widget] ${e}`,...n)}function N(e,...n){console.error(`[Vany Widget] ${e}`,...n)}const S=()=>{const[e,n]=r.useState(null),[o,i]=r.useState(null),[c,l]=r.useState(null),[m,u]=r.useState(!0),[g,f]=r.useState(null);r.useEffect(()=>{b()},[]);const b=async()=>{try{s("ðŸš€ Inicializace Wany Chat widgetu..."),E()||s("âš ï¸ Widget nenÃ­ v iframe - bÄ›Å¾Ã­ standalone");const a=v();n(a),s("âœ… Config naÄten:",a),j(a.theme);const{user:d}=await _();d?(l(d),s("âœ… PÅ™ihlÃ¡Å¡enÃ½ uÅ¾ivatel:",d.email)):s("â„¹ï¸ Å½Ã¡dnÃ½ pÅ™ihlÃ¡Å¡enÃ½ uÅ¾ivatel (anonymnÃ­ chat)");const h=await C("vany_chat");if(!h)throw new Error("NepodaÅ™ilo se naÄÃ­st nastavenÃ­ chatbota vany_chat");i(h),s("âœ… Chatbot settings naÄteny:",h),s("ðŸŽ¯ Chatbot ID:","vany_chat"),u(!1)}catch(a){N("âŒ Chyba pÅ™i inicializaci widgetu:",a),f(a instanceof Error?a.message:"NeznÃ¡mÃ¡ chyba"),u(!1)}};return m?t.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"NaÄÃ­tÃ¡m Wany Chat..."})]})}):g||!e||!o?t.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:t.jsxs("div",{className:"text-center p-8",children:[t.jsx("div",{className:"text-red-500 text-4xl mb-4",children:"âš ï¸"}),t.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Chyba pÅ™i naÄÃ­tÃ¡nÃ­"}),t.jsx("p",{className:"text-gray-600",children:g||"NepodaÅ™ilo se naÄÃ­st konfiguraci"})]})}):t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:t.jsx("div",{className:"w-[1200px] h-[700px] max-w-[95vw] max-h-[90vh] rounded-xl shadow-2xl transition-all duration-300 ease-in-out overflow-hidden",children:t.jsx(p,{currentUser:c,chatbotId:"vany_chat",chatbotSettings:o,onClose:()=>{window.parent!==window&&window.parent.postMessage({type:"WIDGET_CLOSE"},"*")}})})})};console.log("ðŸš€ Widget Entry Point inicializovÃ¡n");const I=x.createRoot(document.getElementById("root"));I.render(t.jsx(w.StrictMode,{children:t.jsx(S,{})}));console.log("âœ… Widget React aplikace renderovÃ¡na");
