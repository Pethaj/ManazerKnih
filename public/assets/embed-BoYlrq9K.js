import"./modulepreload-polyfill-B5Qt9EMX.js";import{r as n,j as t,F as f,s as p,c as b}from"./SanaChat-Bj63mdfm.js";const g=()=>{const[m,i]=n.useState(null),[h,u]=n.useState(!0),[a,r]=n.useState({});return n.useEffect(()=>{console.log("üî• EMBED VANY CHAT - Loading settings...");const s=window.frameElement;if(s){const e={id:s.dataset.userId||"",email:s.dataset.email||"",firstName:s.dataset.firstname||"",lastName:s.dataset.lastname||"",position:s.dataset.position||""};e.id||e.email?(console.log("üìã User data naƒçtena z data-* atribut≈Ø iframe:",e),r(e)):console.log("‚ö†Ô∏è ≈Ω√°dn√° user data v data-* atributech nenalezena")}else console.log("‚ö†Ô∏è window.frameElement nen√≠ dostupn√Ω (mo≈æn√° nen√≠ v iframe)");const d=e=>{e.data.type==="USER_DATA"&&e.data.user&&(console.log("üë§ User data p≈ôijata z rodiƒçe p≈ôes postMessage:",e.data.user),r(e.data.user))};return window.addEventListener("message",d),(async()=>{try{const{data:e,error:o}=await p.from("chatbot_settings").select("*").eq("chatbot_id","vany_chat").single();if(o||!e)console.warn("‚ö†Ô∏è Nelze naƒç√≠st nastaven√≠ z DB, pou≈æ√≠v√°m fallback:",o==null?void 0:o.message),i({chatbot_id:"vany_chat",n8n_webhook_url:"https://n8n.sanaai.cz/webhook/chat-vany",system_prompt:"Jsi AI asistent Sana AI. Pom√°h√°≈° u≈æivatel≈Øm s informacemi o l√©ƒçbƒõ a produktech BEWIT.",name:"Wany Chat",description:"AI chatbot pro podporu a informace"});else{console.log("‚úÖ Chatbot settings loaded from DB:",e);const l={...e,allowed_labels:[]};console.log("üîí EMBED: Vynucuji pr√°zdn√© allowed_labels:",l.allowed_labels),console.log("üîí EMBED: Cel√© nastaven√≠:",l),i(l)}}catch(e){console.warn("‚ö†Ô∏è Exception p≈ôi naƒç√≠t√°n√≠ nastaven√≠, pou≈æ√≠v√°m fallback:",e),i({chatbot_id:"vany_chat",n8n_webhook_url:"https://n8n.sanaai.cz/webhook/chat-vany",system_prompt:"Jsi AI asistent Sana AI. Pom√°h√°≈° u≈æivatel≈Øm s informacemi o l√©ƒçbƒõ a produktech BEWIT.",name:"Wany Chat",description:"AI chatbot pro podporu a informace"})}finally{u(!1)}})(),()=>{window.removeEventListener("message",d)}},[]),h?t.jsx("div",{className:"w-full h-screen flex items-center justify-center bg-bewit-gray",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-bewit-blue mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Naƒç√≠t√°m Wany Chat..."})]})}):t.jsx("div",{className:"w-full h-screen overflow-hidden",children:t.jsx("div",{className:"w-full h-full",children:t.jsx(f,{chatbotId:"vany_chat",chatbotSettings:m,onClose:void 0,currentUser:a.id?{id:a.id,email:a.email||"",firstName:a.firstName||"",lastName:a.lastName||"",role:"spravce",createdAt:new Date().toISOString()}:void 0,externalUserInfo:a.id||a.email?{external_user_id:a.id,first_name:a.firstName,last_name:a.lastName,email:a.email,position:a.position}:void 0})})})},c=document.getElementById("embed-root");if(!c)throw new Error("Failed to find the embed-root element");const w=b.createRoot(c);w.render(t.jsx(n.StrictMode,{children:t.jsx(g,{})}));console.log("üöÄ EMBED ENTRY POINT - Wany Chat initialized");
